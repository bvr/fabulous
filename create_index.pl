
# simple script to create markdown list of all articles on ericlippert.com

use utf8::all;
use Mojo::UserAgent;
use Mojo::URL;
use Data::Dump;

my $ua = Mojo::UserAgent->new(max_redirects => 5);

my $base_url = 'https://ericlippert.com';

# dd $ua->get($base_url)->res;

my $additional = $ua->post(Mojo::URL->new($base_url)->query(infinity => 'scrolling') => form => { 
    'action' => "infinite_scroll",
    'page' => "1",
    'currentday' => "28.02.16",
    'order' => "DESC",
    'scripts[0]' => "wp-polyfill-inert",
    'scripts[1]' => "regenerator-runtime",
    'scripts[2]' => "wp-inert-polyfill",
    'scripts[3]' => "wp-polyfill",
    'scripts[4]' => "jetpack-block-contact-form",
    'scripts[5]' => "mobile-useragent-info",
    'scripts[6]' => "rlt-proxy",
    'scripts[7]' => "wpcom-actionbar-placeholder",
    'scripts[8]' => "grofiles-cards",
    'scripts[9]' => "wpgroho",
    'scripts[10]' => "devicepx",
    'scripts[11]' => "the-neverending-homepage",
    'scripts[12]' => "wpcom-masterbar-tracks-js",
    'scripts[13]' => "jetpack-carousel",
    'scripts[14]' => "tiled-gallery",
    'scripts[15]' => "carousel-wpcom",
    'styles[0]' => "wpcom-smileys",
    'styles[1]' => "the-neverending-homepage",
    'styles[2]' => "wp-block-library",
    'styles[3]' => "wp-block-library-theme",
    'styles[4]' => "mediaelement",
    'styles[5]' => "wp-mediaelement",
    'styles[6]' => "jetpack-layout-grid",
    'styles[7]' => "jetpack-ratings",
    'styles[8]' => "coblocks-frontend",
    'styles[9]' => "classic-theme-styles",
    'styles[10]' => "wpcom-core-compat-playlist-styles",
    'styles[11]' => "wpcom-text-widget-styles",
    'styles[12]' => "wpcom-bbpress2-staff-css",
    'styles[13]' => "twentyeleven-block-style",
    'styles[14]' => "twentyeleven-wpcom-style",
    'styles[15]' => "geo-location-flair",
    'styles[16]' => "reblogging",
    'styles[17]' => "infinity-twentyeleven",
    'styles[18]' => "h4-global",
    'styles[19]' => "videopress-video-style",
    'styles[20]' => "global-styles",
    'styles[21]' => "jetpack-global-styles-frontend-style",
    'styles[22]' => "jetpack-carousel-swiper-css",
    'styles[23]' => "jetpack-carousel",
    'styles[24]' => "tiled-gallery",
    'query_args[year]' => "2016",
    'query_args[monthnum]' => "2",
    'query_args[error]' => "",
    'query_args[m]' => "",
    'query_args[p]' => "0",
    'query_args[post_parent]' => "",
    'query_args[subpost]' => "",
    'query_args[subpost_id]' => "",
    'query_args[attachment]' => "",
    'query_args[attachment_id]' => "0",
    'query_args[name]' => "",
    'query_args[pagename]' => "",
    'query_args[page_id]' => "0",
    'query_args[second]' => "",
    'query_args[minute]' => "",
    'query_args[hour]' => "",
    'query_args[day]' => "0",
    'query_args[w]' => "0",
    'query_args[category_name]' => "",
    'query_args[tag]' => "",
    'query_args[cat]' => "",
    'query_args[tag_id]' => "",
    'query_args[author]' => "",
    'query_args[author_name]' => "",
    'query_args[feed]' => "",
    'query_args[tb]' => "",
    'query_args[paged]' => "0",
    'query_args[meta_key]' => "",
    'query_args[meta_value]' => "",
    'query_args[preview]' => "",
    'query_args[s]' => "",
    'query_args[sentence]' => "",
    'query_args[title]' => "",
    'query_args[fields]' => "",
    'query_args[menu_order]' => "",
    'query_args[embed]' => "",
    'query_args[category__in][]' => "",
    'query_args[category__not_in][]' => "",
    'query_args[category__and][]' => "",
    'query_args[post__in][]' => "",
    'query_args[post__not_in][]' => "",
    'query_args[post_name__in][]' => "",
    'query_args[tag__in][]' => "",
    'query_args[tag__not_in][]' => "",
    'query_args[tag__and][]' => "",
    'query_args[tag_slug__in][]' => "",
    'query_args[tag_slug__and][]' => "",
    'query_args[post_parent__in][]' => "",
    'query_args[post_parent__not_in][]' => "",
    'query_args[author__in][]' => "",
    'query_args[author__not_in][]' => "",
    'query_args[search_columns][]' => "",
    'query_args[lazy_load_term_meta]' => "false",
    'query_args[posts_per_page]' => "50",
    'query_args[ignore_sticky_posts]' => "false",
    'query_args[suppress_filters]' => "false",
    'query_args[cache_results]' => "true",
    'query_args[update_post_term_cache]' => "true",
    'query_args[update_menu_item_cache]' => "false",
    'query_args[update_post_meta_cache]' => "true",
    'query_args[post_type]' => "",
    'query_args[nopaging]' => "false",
    'query_args[comments_per_page]' => "50",
    'query_args[no_found_rows]' => "false",
    'query_args[order]' => "DESC",
    'query_before' => "2023-03-11 06:31:03",
    'last_post_date' => "2016-02-09 06:57:02",
});
my $dom = Mojo::DOM->new($additional->res->json->{html});
for my $article ($dom->find('article')->each) {
    my $title = $article->find('.entry-title > a:nth-child(1)')->first;
    my @tags  = $article->find('span.tag-links > a')->each;
    # join(', ', map { $_->text } @tags) can be used to obtain texts, but does not seem useful
    print " - [ ] [", $title->text, "](", $title->{href}, ")\n";
}

__END__

for my $month ($ua->get($base_url)->res->dom->find('#archives-2 a')->each) {
    warn $month->text, "\n";
    print "\n## [", $month->text, "](", $month->{href}, ")\n";
    for my $article ($ua->get(Mojo::URL->new($month->{href})->query(posts_per_page => -1))->res->dom->find('article')->each) {
        my $title = $article->find('.entry-title > a:nth-child(1)')->first;
        my @tags  = $article->find('span.tag-links > a')->each;
        # join(', ', map { $_->text } @tags) can be used to obtain texts, but does not seem useful
        print " - [ ] [", $title->text, "](", $title->{href}, ")\n";
    }
}

# TODO: The list of articles is not complete for February 2016 (there is probably adding of articles using javascript)



Disable Cache
38 requests
511.63 kB / 48.05 kB transferred
Finish: 22.32 s
DOMContentLoaded: 1.12 s
load: 3.99 s
	
'action' => "infinite_scroll",
'page' => "2",
'currentday' => "09.02.16",
'order' => "DESC",
'scripts[0]' => "wp-polyfill-inert",
'scripts[1]' => "regenerator-runtime",
'scripts[2]' => "wp-inert-polyfill",
'scripts[3]' => "wp-polyfill",
'scripts[4]' => "jetpack-block-contact-form",
'scripts[5]' => "mobile-useragent-info",
'scripts[6]' => "rlt-proxy",
'scripts[7]' => "wpcom-actionbar-placeholder",
'scripts[8]' => "grofiles-cards",
'scripts[9]' => "wpgroho",
'scripts[10]' => "devicepx",
'scripts[11]' => "the-neverending-homepage",
'scripts[12]' => "wpcom-masterbar-tracks-js",
'scripts[13]' => "jetpack-carousel",
'scripts[14]' => "tiled-gallery",
'scripts[15]' => "carousel-wpcom",
'styles[0]' => "wpcom-smileys",
'styles[1]' => "the-neverending-homepage",
'styles[2]' => "wp-block-library",
'styles[3]' => "wp-block-library-theme",
'styles[4]' => "mediaelement",
'styles[5]' => "wp-mediaelement",
'styles[6]' => "jetpack-layout-grid",
'styles[7]' => "jetpack-ratings",
'styles[8]' => "coblocks-frontend",
'styles[9]' => "classic-theme-styles",
'styles[10]' => "wpcom-core-compat-playlist-styles",
'styles[11]' => "wpcom-text-widget-styles",
'styles[12]' => "wpcom-bbpress2-staff-css",
'styles[13]' => "twentyeleven-block-style",
'styles[14]' => "twentyeleven-wpcom-style",
'styles[15]' => "geo-location-flair",
'styles[16]' => "reblogging",
'styles[17]' => "infinity-twentyeleven",
'styles[18]' => "h4-global",
'styles[19]' => "videopress-video-style",
'styles[20]' => "global-styles",
'styles[21]' => "jetpack-global-styles-frontend-style",
'styles[22]' => "jetpack-carousel-swiper-css",
'styles[23]' => "jetpack-carousel",
'styles[24]' => "tiled-gallery",
'query_args[year]' => "2016",
'query_args[monthnum]' => "2",
'query_args[error]' => "",
'query_args[m]' => "",
'query_args[p]' => "0",
'query_args[post_parent]' => "",
'query_args[subpost]' => "",
'query_args[subpost_id]' => "",
'query_args[attachment]' => "",
'query_args[attachment_id]' => "0",
'query_args[name]' => "",
'query_args[pagename]' => "",
'query_args[page_id]' => "0",
'query_args[second]' => "",
'query_args[minute]' => "",
'query_args[hour]' => "",
'query_args[day]' => "0",
'query_args[w]' => "0",
'query_args[category_name]' => "",
'query_args[tag]' => "",
'query_args[cat]' => "",
'query_args[tag_id]' => "",
'query_args[author]' => "",
'query_args[author_name]' => "",
'query_args[feed]' => "",
'query_args[tb]' => "",
'query_args[paged]' => "0",
'query_args[meta_key]' => "",
'query_args[meta_value]' => "",
'query_args[preview]' => "",
'query_args[s]' => "",
'query_args[sentence]' => "",
'query_args[title]' => "",
'query_args[fields]' => "",
'query_args[menu_order]' => "",
'query_args[embed]' => "",
'query_args[category__in][]' => "",
'query_args[category__not_in][]' => "",
'query_args[category__and][]' => "",
'query_args[post__in][]' => "",
'query_args[post__not_in][]' => "",
'query_args[post_name__in][]' => "",
'query_args[tag__in][]' => "",
'query_args[tag__not_in][]' => "",
'query_args[tag__and][]' => "",
'query_args[tag_slug__in][]' => "",
'query_args[tag_slug__and][]' => "",
'query_args[post_parent__in][]' => "",
'query_args[post_parent__not_in][]' => "",
'query_args[author__in][]' => "",
'query_args[author__not_in][]' => "",
'query_args[search_columns][]' => "",
'query_args[lazy_load_term_meta]' => "false",
'query_args[posts_per_page]' => "10",
'query_args[ignore_sticky_posts]' => "false",
'query_args[suppress_filters]' => "false",
'query_args[cache_results]' => "true",
'query_args[update_post_term_cache]' => "true",
'query_args[update_menu_item_cache]' => "false",
'query_args[update_post_meta_cache]' => "true",
'query_args[post_type]' => "",
'query_args[nopaging]' => "false",
'query_args[comments_per_page]' => "50",
'query_args[no_found_rows]' => "false",
'query_args[order]' => "DESC",
'query_before' => "2023-03-11 06:31:03",
'last_post_date' => "2016-02-09 06:57:02",
